---
layout: post
title: 5장 설명과 예측-프로파일링과 예측 모델링
# image: 
#   path: /assets/img/blog/jeremy-bishop@0,5x.jpg
description: >
  프로파일링과 예측 모델링 관련 내용 정리한 글입니다.
sitemap: false
---

<!-- Version 9 is the most complete version of Hydejack yet.
{:.lead}

[Modernized](#linking-in-style) [design](#whats-in-the-cards), [big headlines](#ready-for-the-big-screen), big new features: [Built-In Search](#built-in-search), [Sticky Table of Contents](#sticky-table-of-contents), and [Auto-Hiding Navbar](#auto-hiding-navbar). That [and more](#and-much-more) is Hydejack 9.

- Table of Contents
{:toc .large-only} -->

## 방향성 데이터마이닝 모형들

방향성 데이터마이닝은 우리가 알고 있는 **지도학습**으로써 목표변수에 관한 추론을 하기 위한 모형을 만드는 것과 관련이 있어요. 방향성 데이터마이닝에 대해 
자세히 살펴보려고 합니다.

### 모형 구조와 목표의 정의

방향성 데이터마이닝은 **<span style='color:blue'>목표변수</span>**에 대한 이해와 정의가 필요합니다. 캠페인을 위한 고객을 선택하는 모형이 방향성 데이터마이닝의
예시라고 할 수 있습니다. 이러한 예시를 그림으로 표현하면 아래와 같습니다. 

<img width="508" alt="image" src="https://user-images.githubusercontent.com/107903417/230749749-642174d1-1f43-465d-b83f-96bb9e2ed0cd.png">

증분 응답 모형의 기본적인 아이디어를 그림으로 표현하면 아래와 같습니다. 

<img width="417" alt="image" src="https://user-images.githubusercontent.com/107903417/230750028-9cb072c3-71af-4f18-9cc4-801acea63415.png">

### 모형 **<span style='color:blue'>안정성(Stability)</span>**

우리가 모형을 만드는 목표는 실험실에서 잘 작동하도록 하는 것보다, 실제 상황에서 잘 작동하도록 만드는 것입니다. 이러한 관점에서 **모형 안정성**은 모형이 
모형 뿐 아니라 만나보지 못했던 데이터에서도 잘 작동하는 능력이라고 할 수 있어요. 이러한 모형 안정성을 저해하는 요소는 아래와 같이 4가지가 있습니다. 
- 잘못된 문제를 풀었을 때 : 한 엔지니어링 팀은 미터 단위를 사용하고, 다른 팀은 영국 단위를 사용한 사례
- 과적합(overfitting) : 일반적인 패턴을 인식하는 대신 모형집합을 암기해버리는 현상
- 표본 편향 : 모형 집합이 원래 데이터로부터 임의 표본을 만들지 못했을 때 발생함.
- 미래와 과거가 같지 않음

## 모형 집합의 시간 프레임

모형 집합의 모든 변수는 변수가 기여한 기간과 관련된 **시간 프레임**을 가지고 있습니다. 입력변수와 목표변수 모두 시간 프레임을 가지고 있으며, 
이들의 관계는 매우 중요합니다. 입력변수들이 출력변수보다 앞선 시간 프레임에서 발생하는 경우를 **예측 모형**이라 합니다. 그리고 입력변수와 
출력변수가 동일한 시간 프레임에서 산출된다면, 이는 **프로파일링**모형이라 할 수 있습니다. 이를 그림으로 표현하며 아래와 같습니다.

<img width="401" alt="image" src="https://user-images.githubusercontent.com/107903417/230778901-509e40f6-3baf-4516-a7fc-f0cb895c72c9.png">

### 예측 모형

예측 모형은 앞에서 언급하였듯이 입력변수들이 모두 목표변수 이전에 산출되고 있습니다. 이러한 예측 과제에서 **모형 집합을 생성**하는 데 상당한 작업이 필요합니다.

### 프로파일링 모형

프로파일링 모형은 앞서 언급하였듯이 목표변수와 입력변수가 동일한 시간 프레임인 경우 해당되며, 원인과 결과의 구분이 어렵다는 특징이 있어요.

## 설명모델과 예측모델의 모델링

### 설명모델

**설명모델**에서는 **<span style='color:red'>데이터를 잘 적합시키는 모델</span>**을 **좋은 모델**이라고 합니다. 모델링을 할 때 데이터를 사용할 때 보통 **전체 데이터세트**를 사용합니다. 이러한 이유는 모집단에 가정된 관계에 대한 정보를 최대로 반영한 최적의 적합 모델을 추정하기 때문입니다. 또한 모델에 대한 **성능 측정**을 실시하게 됩니다. 성능을 측정할 때 유념해야 할 점은 **데이터가 모델에 얼마나 잘 적합한지**, 그리고 **평균 관계가 얼마나 강한지** 등이 있습니다.

## 예측모델

예측모델에서는 **<span style='color:red'>새로운 사례를 정확하게 예측하는 모델</span>**을 **좋은 모델**이라고 합니다. 예측모델에서는 데이터를 아래와 같이 2가지로 
분리하고 있습니다. 
- 학습 데이터 : 모델을 추정하는 데 사용
- 검증 데이터 : 예측 모델의 성능평가 시 사용

예측모델의 성능을 측정할 때 유념해야 할 점은 **예측의 정확도** 등이 있습니다.

## 방향성 데이터마이닝 방법론

데이터마이닝 방법론은 **11단계**로 구성되어 있으며, 아래 그림과 같이 선형 프로세스가 아니라는 것을 알 수 있어요.

<img width="415" alt="image" src="https://user-images.githubusercontent.com/107903417/231475950-8fcd1150-03ff-4295-9bae-bae3c905c399.png">

## 1단계:경영 문제를 데이터마이닝 문제로 번역한다.

데이터마이닝 프로젝트의 올바른 목적은 **<span style='color:red'>제대로 정의된 경영 문제</span>**를 해결하는 것입니다. 데이터마이닝 프로젝트의 목표들은
광범위하고 일반적이지 않아야 합니다.
- 광범위하고 일반적인 목표 예시
  - 고객들의 행동에 대한 이해, 데이터에서 의미있는 것의 발견 등

이러한 광범위한 목표들을 **<span style='color:blue'>작은 목표들로 세분화</span>**될 필요가 있어요. 세분화된 목표의 예시는 아래와 같습니다.
- 구독을 갱신하지 않을 가능성이 높은 고객들의 식별
- 와인과 맥주 판매를 중단할 경우, 판매가 줄어들 상품 추출 등

## 2단계:적절한 데이터를 선택한다.

### 무엇이 사용 가능한가

데이터를 찾기 전 가장 먼저 확인애햐 할 곳은 바로 **데이터웨어하우스**입니다. 실제로 문서의 내용이 빠져있거나 지나가버린 데이터가 있어서 쓸모없게 되는 등의 이유로 인해 데이터마이닝에서 사용가능한 데이터를 결정하는데 어려움을 많이 겪고 있어요. 사용가능한 데이터를 파악하기 위해서는 **데이터 사전 검토**, **사용자와 데이터베이스 관리자들 면담**, 그리고 **관련 보고서 검토** 등을 해야 합니다.

### 얼마만큼의 데이터가 충분할까?

소제목의 질문에 대한 단순한 대답은 존재하지 않습니다. 이 질문에 대한 대답은 사용할 특정 알고리즘, 데이터의 복잡성, 그리고 예상되는 결과 등에 의존하고 있어요. 통계학자들은 모형을 만들기 위한 최소한의 모형 집합을 결정하는 방법을 연구하고 있습니다. 상업적 세계에서는 데이터의 분량은 큰 의미가 없습니다.

데이터가 실제로 부족한 상황에서는 데이터마이닝의 효과와 유용성이 떨어지는 것을 알 수 있습니다.

